<!DOCTYPE html>
<html>
<head>
    <title>LBIR1212 - TP5</title>
    <link rel="stylesheet" href="style.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="display.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>

    <h1>LBIR1212 - TP5: Fonction d'une variable</h1>

    <!--Question 5-1 -->

    <div class="question">
        <div class="display-button-div"> <button onclick="toggleDisplay(this)">&#9660;</button> </div>
        <div class="question-content">
            <p><strong>5-1. </strong> Soit $X$ une loi discrète dont la fonction de probabilité est donnée par: $$p(x)=\left\{\begin{array}{ll} kx^2 & x=-2,-1,0,1,2 \\ 0 & \text{ailleurs}\end{array}\right.$$</p>
            <ol class="alpha">
                <li> Calculez $\mathbb{E}[X]$, $Var[X]$ et $\mathbb{E}[|X|]$ </li>
                <li> Soit $Y=X+2$; calculez $\mathbb{E}[Y]$ et $Var[Y]$</li>
                <li> Soit $Z=5X$; calculez $\mathbb{E}[Z]$ et $Var[Z]$</li>
            </ol>
        </div>
    </div>

    <div class="solution" style="display: none">
        <h3>Espérance d'une variable $Y=h(X)$</h3>
        <p>$$\mathbb{E}[Y]=\mathbb{E}[h(X)] = \left\{\begin{array}{ll}
            \sum_{i=1}^nh(x_i)p(x_i) & \text{cas discret} \\
            \int_{-\infty}^{\infty} h(x)f(x)dx & \text{cas continu}
        \end{array}\right.$$</p>
        <p> L'espérance est un opérateur linéaire: $$\mathbb{E}[aX+b] = a\mathbb{E}[X]+b$$</p>
        <h3>Variance d'une variable $Y=h(X)$</h3>
        <p>$$Var[Y]=Var[h(X)]=\mathbb{E}[h^2(X)]-\mathbb{E}^2[h(X)]$$</p>
        <p> La variance n'est pas un opérateur linéaire: $$Var[aX+b] = a^2Var[X]$$</p>
    </div>
    <p></p>

    <!--Question 5-3 -->

    <div class="question">
        <div class="display-button-div"> <button onclick="toggleDisplay(this)">&#9660;</button> </div>
        <div class="question-content">
            <p> <strong>5-3. </strong>  Si $X$ est une loi uniforme sur l’intervalle $[0, 1]$, déterminez les fonctions de densité de probabilité des variables aléatoires suivantes :</p>
            <ol class="alpha flex-ol">
                <li> $Y=3X$ </li>
                <li> $Z=X+5$</li>
                <li> $U=X^3$</li>
                <li> $V=X^{-1}$</li>
                <li> $W=-5\ln X$</li>
            </ol>
        </div>
    </div>

    <div class="solution" style="display: block;">
        <h3>Fonction $h(\cdot)$ strictement monotone ($\nearrow$ or $\searrow$)</h3>
        <p>$$f_{Y}(y) = f_X(h^{-1}(y))\left|\dfrac{dh^{-1}(y)}{dy}\right|$$</p>
        <h3> 2 résolutions alternatives </h3>
        <div class="split">
            <div style="text-align:center">
                <img style="width:80%" src="figures/question_5-3e.png">
            </div>
            <div>
                <h4> Formule pour $h(\cdot)$ strictement monotone</h4>
                <p>$$f_Y(y) = 1 \cdot \left|\dfrac{d(e^{-y/5})}{dy}\right| = \dfrac{e^{-y/5}}{5}$$</p>
                <h4> Cas général </h4>
                <p>$$\begin{align}
                    F_Y(y) &= \int_{e^{-y/5}}^{1}1~dx = 1-e^{-y/5} \\
                    f_Y(y) &= \dfrac{dF_Y(y)}{dy} = \dfrac{1}{5}e^{-y/5}
                \end{align}$$</p>
            </div>
        </div>
    </div>
    <p></p>

    <!--Question 5-4 -->

    <div class="question">
        <div class="display-button-div"> <button onclick="toggleDisplay(this)">&#9660;</button> </div>
        <div class="question-content">
            <p><strong>5-4. </strong> Soit $X$ une loi uniforme sur l’intervalle $[−1, 1]$. Si $Y = X^2$, quelle est la fonction de densité de probabilité de $Y$ ?</p>
        </div>
    </div>

    <div class="solution" style="display: none;">
        <h3>Fonction $h(\cdot)$ quelconque</h3>
        </p> On identifie des événements $A$ et $B$ équivalents ($A \equiv B$) sur les variables $Y = h(X)$ et $X$. </p>
        <div class="split">
            <div>
                <h4>Cas discret</h4>
                <p>$$\left\{\begin{array}{l} A\equiv(Y=y) \\ B\equiv\{x: h(x)=y\} \end{array}\right.\Rightarrow p_Y(y) = \sum_{x\in B}p_X(x)$$</p>
            </div>
            <div>
                <h4>Cas continu</h4>
                <p>$$\left\{\begin{array}{l} A\equiv(Y\leq y) \\ B\equiv\{x: h(x)\leq y\} \end{array}\right.\Rightarrow F_Y(y) = \int_{x\in B}f_X(x)dx$$</p>
                <p>Rappel: $\quad f_Y(y) = \dfrac{dF_Y(y)}{dy}$</p>
            </div>
        </div>
        <div style="text-align: center">
            <img src="figures/question_5-4.png" style="width:70%">
        </div>
    </div>
    <p></p>

    <!--Question 5-5 -->

    <div class="question">
        <div class="display-button-div"> <button onclick="toggleDisplay(this)">&#9660;</button> </div>
        <div class="question-content">
            <p> <strong>5-5. </strong> On arrondit 50 nombres à l’entier le plus proche et l’on effectue leur somme. Si les erreurs d'arrondi individuelles sont distribuées uniformément sur l’intervalle $[−0.5, 0.5]$, quelle est la probabilité que la somme obtenue s'éloigne de plus de 3 par rapport à la somme exacte ? </p>
        </div>
    </div>

    <div class="solution" style="display: none;">
        <h3>Espérance et variance d'une loi uniforme</h3>
        <p>$$X\sim Un(a,b) \Rightarrow \mathbb{E}[X] = \dfrac{b+a}{2}, Var[X] = \dfrac{(b-a)^2}{12}$$</p>
        <h3>Approximation d'une loi par une autre</h3>
        <div style="text-align: center">
            <img src="figures/approx_black.png" style="width:70%">
        </div>
        <h3> Testons la théorie (spoiler Q2)</h3>
<pre><code class="python">import numpy as np
from numpy.typing import NDArray

def eval_error(n_sample: int = 1) -> NDArray:
    return np.random.uniform(-0.5, 0.5, size=(n_sample,50)).sum(axis=1)</code></pre>

    <div style="text-align: center">
        <img src="figures/anim_5-5_optimized.gif" style="width:65%">
    </div>
    </div>
    <p></p>
</body>
</html>
